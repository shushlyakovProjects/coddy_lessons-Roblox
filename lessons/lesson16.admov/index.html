<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROBLOX - Lesson 16</title>
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="../../css/section.css">
    <link rel="stylesheet" href="../../css/media.css">
    <link rel="icon" href="../../img/base/favicon.png">
</head>

<body>

    <!-- 
    ИНСТРУКЦИЯ
    <h1></h1>
    <h2></h2>
    <h3></h3>
    <p></p>
    <p class="story"></p>
    <p class="code"></p>
    <p class="important"></p>
    <img src="" alt="">
    <div class="box__images2"> 
    -->

    <main>
        <header>
            <img src="../../img/base/logo.svg" alt="" class="logo">
            <h1>Создание игр в Roblox Studio</h1>
        </header>

        <section>
            <h1>Программирование на Lua. Функции</h1>

            <h2>Что такое функция?</h2>
            <h3>Функции в программировании</h3>
            <img src="img/Screenshot_1.png" alt="">
            <p>На самом деле мы уже не раз встречались с функциями. Команды print() и wait() - это встроенные функции языка LUA.</p>
            <p class="important">Функция - заранее написанная и предопределённая последовательность действий (алгоритм), которая, в отличие от простого программного кода, не выполняется автоматически в момент нажатия на кнопку Play, а ожидает специальной команды для начала выполнения внутри скрипта.</p>
            <p>Эта команда называется «вызов функции» - чтобы выполнить написанные в функции действия, нужно просто написать ее называние в программном коде.</p>

            <p class="story">Если сказать более образно, то при создании функции мы «обучаем» объект делать какое-то сложное действие и говорим, что, когда мы напишем название этого действия, объект должен его выполнить.</p>
            <p>Это можно сравнить с дрессировкой собак: когда у вас есть собака, не знающая команду «дай лапу», сколько бы вы ни пытались говорить ей эту команду, она не сможет ее выполнить. Однако, если собаку обучить этой команде один раз, в будущем она сможет совершать это сложное (для собаки) действие, просто услышав правильную фразу.</p>
            <p>При этом собака, умеющая подавать лапу, не делает этого постоянно - она просто знает, что умеет это делать и ждет команды. Таким же образом и функция, единожды написанная в программном коде, не выполняется при запуске скрипта, пока не будет вызвана в программном коде. Написав ее имя, мы автоматически выполним все действия, описанные внутри нее.</p>
            <p>Обычно функции применяются для экономии времени и оптимизации программного кода, когда у вас есть достаточно сложное действие, состоящее из нескольких команд и повторяющееся в разных местах программы.</p>
            <p>Если этот код копировать и вставлять этот код - это сделает текст менее читабельным и менее удобным для справок. Вместо этого мы можем создать функцию, удобным образом ее назвать и выполнять это действие в нужных местах всего лишь одной строкой.</p>

            <h3>Функции в Lua</h3>
            <p>Для того, чтобы создать функцию, необходимо написать ключевое слово <b>function</b> и после этого указать имя функции.</p>
            <p><b>Обратите внимание:</b> после имени функции всегда должны стоять скобки - это место для параметров функции, если они у неё присутствуют.</p>
            <p class="story">Базовая структура написания функций строится следующим образом:</p>
            <p class="code">function Имя_функции()<br>[действия]<br>end</p>
            <p>Рассмотрим использование функций в языке Lua.</p>

            <h2>Простые функции</h2>
            <h3>Задача 1 - Функция открытия двери</h3>
            <img src="img/Screenshot_2.png" alt="">
            <p>Первая задача знакомит с созданием и использованием функции. В ней необходимо написать простую функцию, открывающую дверь, к которой она прикреплена. При этом, в отличие от предыдущих решений, в этот раз мы напишем универсальную функцию, которая будет открывать любую дверь, вне зависимости от размеров двери.</p>
            <p class="story">Создадим скрипт внутри группы Task1 и сделаем ссылку на дверь (Task1_Door). После этого начнём писать функцию openDoor():</p>
            <img src="img/Screenshot_3.png" alt="">

            <p>Алгоритм работы функции следующий: функция должна получить высоту двери, после этого запустить цикл, который будет перемещать дверь вниз на 1 юнит столько раз, сколько юнитов дверь составляет в высоту.</p>
            <p class="story">То есть, дверь в 20 юнитов нужно переместить вниз на 1 юнит 20 раз. Для двери в 35 юнитов - 35 раз.</p>
            <p>Введём переменную height, которая будет хранить в себе высоту двери. Эта переменная создается внутри функции, поэтому перед ней необходимо поставить ключевое слово local - специальное обозначение, говорящее о том, что эта переменная доступна только внутри ее родительской функции, а за ее пределами попросту не будет существовать.</p>
            <img src="img/Screenshot_4.png" alt="">
            <p class="story">После этого напишем цикл for, который будет перемещать дверь и запустим игру. Ничего не происходит.. Хмм, почему же?</p>
            <img src="img/Screenshot_5.png" alt="">
            <p class="story">Потому что нужно добавить вызов функции в конце программы, чтобы запустить написанную функцию:</p>
            <img src="img/Screenshot_6.png" alt="">

            <h3>Задача 2 - Анимация поршня и двери</h3>
            <img src="img/Screenshot_7.png" alt="">
            <p>В данной задаче есть поршень, находящийся под кнопкой. Необходимо написать функцию, которая заставит поршень перемещаться наверх, пока он не достигнет кнопки, а после этого вызвать другую функцию для открытия двери.</p>
            <p>В итоге мы создадим небольшую анимированную сцену, в которой поршень начнёт двигаться наверх, нажмёт на кнопку, после этого двери начнут двигаться вниз и откроется проход.</p>
            <p class="story">Для начала создадим скрипт в группе Task2 и скопируем текст скрипта из предыдущей задачи - благодаря тому, что мы написали универсальную функцию, мы можем применить её и здесь.</p>
            <p class="story">Поменяем ссылку на дверь, добавим переменную со ссылкой на поршень и начнём писать функцию для его анимации:</p>
            <img src="img/Screenshot_8.png" alt="">
            
            <p>Способ передвижения поршня будет такой же, как и у двери, однако, высота его передвижения не будет равна высоте поршня. Нужно самостоятельно найти расстояние, на которое он должен подняться до того момента, как упрется в кнопку. Для этого посмотрим на координаты поршня в нижнем положении, переместим его в верхнее положение и найдём разницу.</p>
            <p>Если хочется пропустить этот шаг, используем 20 повторений:</p>
            <img src="img/Screenshot_9.png" alt="">
            <p class="story">После окончания цикла, по условию задачи необходимо вызвать функцию openDoor(). Для этого добавим строку и напишем ее название.</p>
            <p class="story">Функция готова! Добавим вызов функции, небольшую паузу между движениями, и задача будет решена:</p>
            <img src="img/Screenshot_10.png" alt="">

            <h2>Параметры функций</h2>
            <h3>Задача 3 - Функция для поднятия ступеней</h3>
            <img src="img/Screenshot_11.png" alt="">
            <p>В этой задаче нам необходимо написать функцию, поднимающую ступени над лавой. Каждая ступень должна подняться на свое собственное количество юнитов, указанное на стене слева (5, 10, 15 и 20 юнитов соответственно).</p>
            <p>Если решать эту задачу способом, который мы использовали ранее, то придётся написать пять разных функций - по одной на каждую высоту. Это неэффективный способ, занимающий слишком много времени и пространства в программном коде.</p>
            <p>Если мы будем использовать статичные значения, то другого варианта нет. Однако вместо них мы будем использовать переменную, которая будет принимать разные значения в зависимости от поднимаемой ступени. Назовем ее height. Ступени тоже будут разные - для них введём переменную platform.</p>
            <p>Чтобы понять, как решать такой тип задач, нужно подумать о ней не с точки зрения конкретных чисел, а с точки зрения действий, которые должны происходить, и написать их алгоритм - абстрактную последовательность действий, не опирающуюся на конкретные числа.</p>
            
            <p class="story">Общий алгоритм функции звучит так:</p>
            <p>1. Получить значение переменной height для активной ступени<br>2. Переместить ступень step на 1 юнит. Повторить это действие height раз.</p>
            <p>Действия, выполняющиеся для каждой ступени, абсолютно одинаковые, изменяется только значение переменной height. При этом переменная height должна изменяться в момент каждого вызова функции.</p>
            <p class="important">Такие переменные называются параметрами функции и задаются особым образом - они указываются в скобках после имени функции. Их значение указывается в скобках во время вызова функции.</p>
            <p class="story">Например:</p>
            <p class="code">function plus(a,b)  --создание функции<br>print(a+b)<br>end<br><br>plus(6,9)    --вызов функции со значениями 6 и 9</p>

            <p>В этом примере написана функция сложения, которая выводит сумму двух чисел. В момент написания функции мы не знаем, какими будут эти числа, но мы точно знаем, что они тут будут.</p>
            <p>Поэтому вместо значений мы пишем, как в математических формулах, неизвестные - а и b. Это параметры функции, переменные, которые используются внутри для описания алгоритма ее работы, без привязки к конкретным значениям.</p>
            <p>Чтобы задать значение параметра, его необходимо вписать в скобках при вызове функции - именно для этого скобки есть у каждой функции. В этом примере значение а - 6, b - 9.</p>
            <p>Если вызвать эту функцию ещё раз, но указать другие значения а и b, она выполнит те же действия, но уже с другими значениями.</p>
            
            <p><b>Запишем функцию с параметрами</b></p>
            <p class="story">Итак, вернёмся к задаче. Создадим скрипт для группы Task3, введём переменные для каждой ступени в уровне:</p>
            <img src="img/Screenshot_12.png" alt="">
            <p class="story">Далее необходимо написать функцию, которая будет поднимать ступень platform на высоту height. Запишем это как функцию с двумя параметрами:</p>
            <img src="img/Screenshot_13.png" alt="">
            <p class="story">Добавим цикл для перемещения ступени, такой же, как и в предыдущих задачах для двери:</p>
            <img src="img/Screenshot_14.png" alt="">
            <p>Теперь при вызове функции мы можем указать при помощи параметров, какая именно ступень (первый параметр) будет перемещаться, и на какое расстояние (второй параметр).</p>
            <p class="story">Последовательно вызовем эту функцию для всех четырех платформ:</p>
            <img src="img/Screenshot_15.png" alt="">
            <p>Готово!</p>

            <h2>Встроенные функции Roblox. Методы Instance</h2>
            <img src="img/Screenshot_16.png" alt="">
            <p>Помимо встроенных функций (print, wait и т.п.) и функций, которые мы можем написать самостоятельно, в Roblox существуют также общие функции для работы с объектами.</p>
            <p>Это функции, позволяющие выполнять общие для всех объектов действия: уничтожение, клонирование, получение дочерних или родительских объектов и многое другое.</p>
            <p class="important">Такие функции вызываются специальным образом: нужно написать название объекта поставить «:» и написать название функции.</p>
            <p class="story">Например:</p>
            <p class="code">Harry = James:FindFirstChild()<br>BankZ:Destroy()</p>
            <p>Таких функций в Roblox около 20 ( <a href="https://create.roblox.com/docs/reference/engine/classes/Instance">Instance</a>) и они могут работать только с объектами класса Instance (это базовый родительский класс любого объекта в Roblox).</p>
            <p class="important">Такие функции, работающие только с одним классом, называются методами.</p>
            
            <p>В этом задании уже есть скрипт, который нужно дополнить новой функцией. В скрипте написан цикл, получающий количество дочерних объектов в группе DestroyBlocks. Этот цикл будет выполняться, пока в ней не останется ни одного дочернего объекта.</p>
            <img src="img/Screenshot_17.png" alt="">
            <p>Наша задача - написать функцию, которая будет уничтожать блоки, находя первый дочерний объект в этой группе. Для этого мы будем использовать методы :FindFirstChild(), возвращающий первый найденный дочерний объект сущности, для которой был вызван, и :Destroy(), уничтожающий объект.</p>
            <p class="story">Добавим функцию DestroyBlock с параметром name:</p>
            <img src="img/Screenshot_18.png" alt="">
            <p>Далее создадим локальную переменную block, в которую будем записывать первый найденный в группе дочерний объект DestroyBlocks.</p>
            <p class="story">Для этого используем метод :FindFirstChild(). В его скобки передадим параметр name - это имя искомого блока.</p>
            <img src="img/Screenshot_19.png" alt="">
            <p class="story">После того, как мы нашли блок, его нужно уничтожить. Для этого вызовем метод :Destroy() для переменной block:</p>
            <img src="img/Screenshot_20.png" alt="">

            <p>Если оставить код в этом виде, то рано или поздно произойдет следующая ошибка: код удалит все блоки с искомым названием, попытается найти и записать в переменную block пустоту, а после попробует удалить ее в следующей строке. Дойдя до этого момента, скрипт сломается и остановится.</p>
            <p>Поэтому перед тем, как удалять объект в переменной block, нам нужно проверить, не содержит ли она в себе пустоту, то есть не является ли она «нулевой». Для этого сравним ее значение с ключевым словом nil - это обозначение несуществующего значения, «пустоты».</p>
            <p class="story">Мы не можем удалить несуществующий объект, поэтому команда :Destroy() должна выполняться только в том случае, если значение block не является нулевым:</p>
            <img src="img/Screenshot_21.png" alt="">
            <p class="story">Теперь добавим в изначальный цикл вызов этой функции для всех трех типов блоков в группе:</p>
            <img src="img/Screenshot_22.png" alt="">


            <hr>
            <h1>Домашкаа 😁</h1>
            <p>Это завершающее занятие четвёртого модуля, поэтому в качестве
                домашнего задания предстоит пройти тест на знания, полученные
                за последние 4 занятия.</p>

            <ol>
                <li>
                    <p>Что такое скрипт?</p>
                    <ol type="a">
                        <li>Сценарий игры, по которому развивается сюжет</li>
                        <li>Специальный объект, выполняющий программный код</li>
                        <li>Предмет, в котором можно писать послания другим игрокам</li>
                    </ol>
                </li>
                <li>
                    <p>Какую конструкцию нужно использовать для повтора действия?</p>
                    <ol type="a">
                        <li>Функция</li>
                        <li>Условие</li>
                        <li>Цикл</li>
                    </ol>
                </li>
                <li>
                    <p>Какой из циклов может быть бесконечным?</p>
                    <ol type="a">
                        <li>For</li>
                        <li>While</li>
                        <li>Оба</li>
                        <li>Цикл не может быть бесконечным</li>
                    </ol>
                </li>
                <li>
                    <p>Что такое переменная?</p>
                    <ol type="a">
                        <li>Значение, которое может изменяться во время игры</li>
                        <li>Область памяти для хранения временных игровых паролей</li>
                        <li>Числовое значение уровня здоровья игрового персонажа</li>
                    </ol>
                </li>
                <li>
                    <p>Выберите все верные утверждения о переменной:</p>
                    <ol type="a">
                        <li>Значение переменной может изменяться во время игры</li>
                        <li>У каждой переменной должно быть имя</li>
                        <li>Имя переменной может включать любые символы (кроме цифр)</li>
                        <li>Переменная может хранить не только числа, но и текст, объекты и т.д.</li>
                        <li>Переменная не может принимать значение, меньшее нуля</li>
                    </ol>
                </li>
                <li>
                    <p>Что такое условие?</p>
                    <ol type="a">
                        <li>Выражение, от истинности которого зависит выполнение программы</li>
                        <li>Окружение, в котором выполняется скрипт</li>
                        <li>Требования к игроку для выполнения скрипта</li>
                    </ol>
                </li>
                <li>
                    <p>При каких значениях переменных программный код запустится?</p>
                    <p class="code">if a>b and b==c then<br>print("Hello, World!")<br>end</p>
                    <ol type="a">
                        <li>a=2, b=5, c=5</li>
                        <li>a=7, b=3, c=10</li>
                        <li>a=15, b=1, c=1</li>
                    </ol>
                </li>
                <li>
                    <p>Что такое функция?</p>
                    <ol type="a">
                        <li>Назначение скрипта</li>
                        <li>Часть программы, которую можно запускать в нужные моменты</li>
                        <li>Специальный вид условной конструкции for</li>
                    </ol>
                </li>
                <li>
                    <p>Что нужно сделать, чтобы запустить функцию?</p>
                    <ol type="a">
                        <li>Вызывать её в нужном месте программы, написав её название</li>
                        <li>Запустить игру и нажать специальную кнопку для активации скрипта</li>
                        <li>Написать её название в чате во время игры</li>
                    </ol>
                </li>
                <li>
                    <p>Для чего функции нужны скобки?</p>
                    <ol type="a">
                        <li>Чтобы отличать функцию от переменной</li>
                        <li>Для указанния порядка выполнения функций</li>
                        <li>Для указанния значений параметров функций</li>
                        <li>Все вышеперечисленное</li>
                    </ol>
                </li>
            </ol>

        </section>
    </main>
</body>

</html>